"use strict";var State=function(){function e(e,t,n){this.selected_text=null,this.input_area=e,this.darkMode_btn=t,this.style_sheet=n,null===localStorage.getItem("darkMode")&&localStorage.setItem("darkMode","true"),"true"===localStorage.getItem("darkMode")&&(this.darkMode_btn.checked=!0,this.changeDarkMode())}return Object.defineProperty(e.prototype,"_darkMode_btn",{get:function(){return this.darkMode_btn},enumerable:!0,configurable:!0}),e.prototype.changeDarkMode=function(){this.darkMode_btn.checked?(this.style_sheet.setProperty("--text",white),this.style_sheet.setProperty("--background",black),localStorage.setItem("darkMode","true")):(this.style_sheet.setProperty("--text",black),this.style_sheet.setProperty("--background",white),localStorage.setItem("darkMode","false"))},e}(),Jisho=function(){function a(e,t){this.word_items=["kotb","eigo","kwsk","btmi","mnim"],this.last_random_word="";var n=this,a=new XMLHttpRequest;a.overrideMimeType("application/json"),a.open("GET",e,!0),a.onreadystatechange=function(){a.readyState==XMLHttpRequest.DONE&&200==a.status&&(n.jisho_data=JSON.parse(a.responseText||"null"),n.tango_quantity=Object.keys(n.jisho_data).length)},a.send(),this.krngJisho_instance_name=t}return a.hiraToKata=function(e){return e.replace(/[\u3041-\u3096]/g,function(e){return String.fromCharCode(e.charCodeAt(0)+96)})},a.zenToHan=function(e){return e.replace(/[Ａ-Ｚａ-ｚ０-９]/g,function(e){return String.fromCharCode(e.charCodeAt(0)-65248)})},Object.defineProperty(a.prototype,"_tango_quantity",{get:function(){return this.tango_quantity},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"_last_random_word",{get:function(){return this.last_random_word},enumerable:!0,configurable:!0}),a.prototype.containing=function(e,t,n){return e=(e=e.replace(/\s+/g,"")).toLowerCase(),t=t.toLowerCase(),n?e===t:!!e.match(t)||(!!e.match(a.hiraToKata(t))||!!e.match(a.zenToHan(t)))},a.prototype.search=function(e,t){if("--all"===e)return this.jisho_data;if(!t){var n={},a=0;for(var r in this.jisho_data)for(var o in this.word_items){s=this.word_items[o];if(this.containing(this.jisho_data[r][s],e,t)){n[a]=this.jisho_data[r],a++;break}}return n}var s=this.word_items[0];for(var r in this.jisho_data)if(this.containing(this.jisho_data[r][s],e,t))return[this.jisho_data[r]];return[{"":""}]},a.prototype.generateHTML=function(e){var t='<div class="tango">';for(var n in e)if(""!==e[n])switch(n){case"kotb":t+='<div class="tango_head"><h2 class="'+n+'">'+e[n]+"</h2>";break;case"kwsk":t+='</div><p class="'+n+'">'+e[n]+"</p>";break;case"eigo":case"btmi":case"mnim":case"tigg":t+='<p class="'+n+'">'+e[n]+"</p>";break;case"krng":var a="random_"+Math.random().toString(32).substring(2);t+='<div class="'+n+'"><label class="krng_facade" for="'+a+'" value="'+e[n]+'" onClick="'+this.krngJisho_instance_name+'.createKanrengo(this)"></label><input id="'+a+'" class="krng_checkbox" type="checkbox"><div class="krng_contents"></div></div>'}return t+="</div>"},a.prototype.createResult=function(e){var t="";e=e.replace(/\s+/g,"");var n=this.search(e,!1);if(Object.keys(n).length)for(var a in n)t+=this.generateHTML(n[a]);else t+='<h2 class="nothing">nothing</h2>';return t},a.prototype.createExactResult=function(e){return this.generateHTML(this.search(e,!0)[0])},a.prototype.createRandomOneTangoResult=function(){var e=Math.floor(Math.random()*this.tango_quantity),t=this.jisho_data[e];return this.last_random_word=t[this.word_items[0]],this.generateHTML(t)},a.prototype.createKanrengo=function(e){var t=e.nextElementSibling.nextElementSibling,n=e.getAttribute("value").split(","),a="";if(!t.innerHTML)for(var r in n)a+=this.createExactResult(n[r]);t.innerHTML=a},a}(),Hoshi=function(){function t(){var e=Math.floor(100*Math.random());this.element=t.createImageElement(99===e?t.hoshiPath_superRare1:98===e?t.hoshiPath_superRare2:97===e?t.hoshiPath_superRare3:70<=e?t.hoshiPath_rare:t.hoshiPath_normal)}return t.createImageElement=function(e){var t=document.createElement("img");return t.classList.add("hoshi"),t.setAttribute("src",e),t},Object.defineProperty(t.prototype,"_element",{get:function(){return this.element},enumerable:!0,configurable:!0}),t.hoshiPath_normal="images/hoshixxx.svg",t.hoshiPath_rare="images/hoshixxx_a1.svg",t.hoshiPath_superRare1="images/hoshixxx_a2.svg",t.hoshiPath_superRare2="images/hoshixxx_a3.svg",t.hoshiPath_superRare3="images/hoshixxx_a4.svg",t}(),all_area=document.getElementById("wrap"),result_area=document.getElementById("result_area"),quickSearch_btns=document.getElementsByClassName("quickSearch_btn"),tangoSu_area=document.getElementById("tangoSu"),qrcode_btn=document.getElementById("qrcode_btn"),nyuryoku_btn=document.getElementById("nyuryoku_btn"),random_btn=document.getElementById("random_btn"),guguru_btn=document.getElementById("guguru_btn"),guguru_url="https://www.google.com/search?q=",black="#555",white="#FFF",blue="#3CC",yello="#FF6",pink="#F9F",green="#9F6",orange="#F93",purple="#96F",state=new State(document.getElementById("input_area"),document.getElementById("darkMode_btn"),document.documentElement.style),jisho=new Jisho("jisho.json","jisho");document.addEventListener("DOMContentLoaded",function(){for(var e=function(e){quickSearch_btns[e].addEventListener("click",function(){window.scrollTo({top:0,behavior:"smooth"}),state.input_area.value=quickSearch_btns[e].getAttribute("value"),result_area.innerHTML=0===state.input_area.value.indexOf("--")?jisho.createResult(state.input_area.value):jisho.createExactResult(state.input_area.value)})},t=0;t<quickSearch_btns.length;t++)e(t)}),window.addEventListener("load",function(){console.log("a"),tangoSu_area.innerHTML=String(jisho._tango_quantity)}),state.input_area.addEventListener("keyup",function(){result_area.innerHTML=""!==state.input_area.value?jisho.createResult(state.input_area.value):""}),all_area.addEventListener("touchend",function(){state.selected_text=window.getSelection().toString(),state.selected_text?guguru_btn.classList.add("guguru_btn__sentaku"):guguru_btn.classList.remove("guguru_btn__sentaku")}),state._darkMode_btn.addEventListener("change",function(){state.changeDarkMode()}),qrcode_btn.addEventListener("click",function(){qrcode_btn.nextElementSibling.classList.toggle("qrcode__open")}),nyuryoku_btn.addEventListener("click",function(){state.input_area.focus()}),random_btn.addEventListener("click",function(){var e=(new Hoshi)._element;all_area.appendChild(e),window.scrollTo({top:0,behavior:"smooth"}),result_area.innerHTML=jisho.createRandomOneTangoResult(),state.input_area.value=jisho._last_random_word}),guguru_btn.addEventListener("click",function(){state.selected_text?(window.open(guguru_url+state.selected_text),state.selected_text=null,guguru_btn.classList.remove("guguru_btn__sentaku")):window.open(guguru_url+state.input_area.value)});